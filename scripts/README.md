# Scripts

Директория содержит скрипты для автоматизации различных задач проекта.

## upload_logos.sh

Shell скрипт для загрузки логотипов Росатома в S3 хранилище через API FastAPI приложения.

### Функциональность

- Автоматический поиск логотипов в различных директориях проекта
- Проверка доступности API приложения
- Проверка наличия файлов в S3 бакете `nko-logo` через API
- Загрузка только отсутствующих файлов (избегает дублирования)
- Подробное цветное логирование всех операций
- Автоматическое создание бакета через API при его отсутствии
- Работа без внешних S3 клиентов

### Требования

- Запущенное FastAPI приложение с S3 эндпоинтами
- Установленный curl
- Опционально: jq для красивого вывода JSON
- Настроенные переменные окружения (см. `backend/.env.example`)

### Установка зависимостей

```bash
# Установка curl (обычно уже установлен)
# Ubuntu/Debian
sudo apt-get install curl

# macOS
brew install curl

# Установка jq для красивого вывода (опционально)
# Ubuntu/Debian
sudo apt-get install jq

# macOS
brew install jq
```

### Использование

```bash
# Запуск скрипта
./scripts/upload_logos.sh

# Или
bash scripts/upload_logos.sh
```

### Поиск файлов

Скрипт ищет логотипы в следующих директориях:
- `logos/`
- `frontend/public/images/`
- `shrifty/`
- `frontend/public/fonts/`

### Ожидаемые файлы

- `LOGO_ROSATOM_rus_HOR_COLOR_PNG.png`
- `LOGO_ROSATOM_rus_HOR_WHITE_PNG.png`
- `LOGO_ROSATOM_rus_VERT_COLOR_PNG.png`
- `LOGO_ROSATOM_rus_VERT_WHITE_PNG.png`

### Логирование

- Цветной консольный вывод прогресса
- Файл логов: `scripts/upload_logos.log`
- Метки времени для всех операций

### Переменные окружения

Скрипт использует переменные из `backend/.env`:
- `API_HOST` - хост API приложения (по умолчанию localhost)
- `API_PORT` - порт API приложения (по умолчанию 8000)

### API эндпоинты

Скрипт использует следующие эндпоинты приложения:
- `GET /health` - проверка доступности API
- `POST /s3/buckets/{bucket_name}` - создание бакета
- `GET /s3/buckets/{bucket_name}/objects` - список объектов в бакете
- `POST /s3/upload` - загрузка файла

### Пример вывода

```
[2024-01-15 10:30:00] Проверка зависимостей...
[SUCCESS] Все зависимости найдены
[2024-01-15 10:30:01] API endpoint: http://localhost:8000
[2024-01-15 10:30:01] Bucket: nko-logo
[2024-01-15 10:30:02] Проверка доступности API...
[SUCCESS] API доступен
[2024-01-15 10:30:03] Найден логотип: LOGO_ROSATOM_rus_HOR_COLOR_PNG.png в logos/LOGO_ROSATOM_rus_HOR_COLOR_PNG.png
[SUCCESS] Найдено логотипов: 4
[2024-01-15 10:30:04] Проверка бакета: nko-logo
[SUCCESS] Бакет уже существует
[2024-01-15 10:30:05] Загрузка: LOGO_ROSATOM_rus_HOR_COLOR_PNG.png (24997 bytes)
[SUCCESS] Загружен: LOGO_ROSATOM_rus_HOR_COLOR_PNG.png
[SUCCESS] Загрузка логотипов завершена
```

### Преимущества

- **Работает через API**: Не требует прямого доступа к S3
- **Идемпотентность**: Можно запускать многократно без дублирования
- **Автоматизация**: Не требует ручного указания путей к файлам
- **Интеграция**: Использует существующие эндпоинты приложения
- **Минимальные зависимости**: Только curl и запущенное приложение